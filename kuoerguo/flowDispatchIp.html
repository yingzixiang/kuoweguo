<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="css/common.css">
    <style>
        .listTitle div{
            font-size: 0.18rem;
            float: left;
            width:12%;
            text-align: center;
        }
        .listContent_item div{
            font-size: 0.18rem;
            float: left;
            width:12%;
            text-align: center;
        }
        .right_part .first{
            width:10%;
        }
        .right_part .second{
            width:15%;
        }
        #section .right_part{
            width:100%;
        }
        #section .right_part .right_part_content{
            margin-left: 0.2rem;
        }
        #section .add{
            height:0.4rem;
        }
        select{
        	width:100%;
        }
    </style>
</head>
<body>
<div id="section">
    <div class="right_part">
        <div class="right_part_content">
        	<div>
        		<span>外网地址：</span>
                <select class="outNet_add" style="width: 240px;"></select>
        		<span>outlink_add</span>
                <select class="outlink_addr_add" style="width: 240px;"></select>
                <span class="marginLeft">route_priority：</span>
                <input class="route_priority" type="text" onkeyup="(this.v=function(){this.value=this.value.replace(/[^0-9-]+/,'');}).call(this)" onblur="this.v();"/>
                <span class="marginLeft">route_en：</span>
            </div>
            <div>
            	 <select class="route_en_add" style="width: 120px;">
                	<option value="0">0</option>
                	<option value="1">1</option>
                </select>
                <button class="add infoAdd">添加</button>
            </div>	
            <div class="listTitle">
            	<div><span>外网地址</span></div>
                <div><span>outlink_add</span></div>
                <div><span>outlink_en</span></div>
                <div><span>outlink_un</span></div>
                <div><span>route_en</span></div>
                <div><span>route_priority</span></div>
                <div><span>route_un</span></div>
                <div class="clear"></div>
            </div>
            <div class="listContent">
            </div>
        </div>
        </div>
    </div>
</div>
</body>
<script src="js/jquery-3.1.1.min.js"></script>
<script src="js/scoket.js"></script>
<script src="js/layer/layer.js"></script>
<script src="js/common.js"></script>
<script src="js/net.js"></script>
<script src="js/flowDispatchIp.js"></script>
<script>

	$(function() {
			var str = window.location.href;
			var nums=str.substring(str.indexOf("?%C2%A0")+7);
			$.ajax({
				url: "http://" + realname + "/v1/global/default/?type=schedule&addr="+nums,
				type: 'get',
				dataType: 'json',
				success: function(data) {
					if(data.retcode == 0) {
						var outlinkNum = "";
						var routeNum = "";
						var dateHtml = "";
		 				for (var o in data.value){
		 					for( var v in data.value[o]){
		 						if(v="default"){
		 							for(var m in data.value[o][v]){
		 								for(var n in data.value[o][v][m]){
						 					dateHtml += '<div class="listContent_item">';
						 					dateHtml += '<div class="listId">'+ data.value[o][v][m][n].netlinkset_id +'</div>'
						 					dateHtml += '<div class="listId">'+ data.value[o][v][m][n].routeset_id +'</div>'
						 					dateHtml += '<div class="listId">'+ data.value[o][v][m][n].route_id +'</div>'
						 					dateHtml += '<div>'+ m +"</div>"
											dateHtml += '<div><select disabled="disabled" class="outlink_addr"><option value="0">'+ data.value[o][v][m][n].outlink_addr +'</option></select></div>'
											dateHtml += '<div><span>&nbsp;' + data.value[o][v][m][n].outlink_en + '</span></div>';
											dateHtml += '<div><span>&nbsp;' + data.value[o][v][m][n].outlink_un + '</span></div>';
											dateHtml += '<div><select disabled="disabled" class="route_en"><option value="0">0</option><option value="1">1</option></select></div>';
											dateHtml += '<div><input class="priority" disabled="disabled" onkeyup="(this.v=function(){this.value=this.value.replace(/[^0-9-]+/,\'\');}).call(this)" onblur="this.v();" value ='+ data.value[o][v][m][n].route_priority +'></div>'
											dateHtml += '<div>'+ data.value[o][v][m][n].route_un +'</div>';
											dateHtml += '<div class="change-delete"><span class="amend">修改 </span><span> / <span class="delete"> 删除</span></span></div><div class="confirm">确认</div><div class="clear"></div></div>';
										
											outlinkNum = data.value[o][v][m][n].outlink_en; 
											routeNum = data.value[o][v][m][n].route_en;
		 								}
		 							}
		 							break;
		 						}
		 						arr.push("0")
		 						
		 					}
		 				}
						$(".listContent").html(dateHtml);
						
						if(routeNum) $(".route_en").find("option[value='1']").attr("selected",true);
						else $(".route_en").find("option[value='0']").attr("selected",true);
					}
				},
				error: function() {
					alert("报错了！！！")
				}
			})
			//获取外网地址
			$.ajax({
				url: "http://" + realname + "/v1/netlinkset",
				type: 'get',
				dataType: 'json',
				success: function(data) {
					if(data.retcode == 0) {
						var getOutNet_add = "";
						for(var i=0; i<data.value.length; i++){
							getOutNet_add += '<option value="'+ data.value[i].Id +'">'+ data.value[i].Name +'</option>'
						}
						$(".outNet_add").html(getOutNet_add)
					}
				},
				error: function() {
					alert("报错了！！！")
				}
			})
			//获取outlink_addr
			$.ajax({
				url: "http://" + realname + "/v1/outlink",
				type: 'get',
				dataType: 'json',
				success: function(data) {
					if(data.retcode == 0) {
						var getOutlink_add = "";
						for(var i=0; i<data.value.length; i++){
							getOutlink_add += '<option value="'+ data.value[i].Id +'">'+ data.value[i].Name +'</option>'
						}
						$(".outlink_addr_add").html(getOutlink_add);
					}
				},
				error: function() {
					alert("报错了！！！")
				}
			})
			
		})
</script>

</html>
